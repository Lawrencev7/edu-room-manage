<!DOCTYPE HTML>
<html lang="en">
<#include "common/head.html"/>
<body>
<section class="content">
  <#if errorMessage??>
    <div class="alert alert-success alert-dismissible fade in" role="alert">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span>
      </button>
      ${errorMessage!}
    </div>
  </#if>
  <div class="row">
    <div class="col-md-6 col-md-offset-3">
      <div class="box box-primary">
        <div class="box-header with-border">
          <h3 class="box-title">个人信息</h3>
        </div>
        <div class="box-body">

          <form class="form-horizontal js-ajax-form" action="/console/user/merge" method="post" enctype="multipart/form-data">
            <input type="hidden" name="id" id="id" value="${user.id!}"/>
            <div class="form-group">
              <label for="password" class="col-sm-2 control-label">我的职位</label>
              <div class="col-sm-10">
                <#if user.roleList?size gt 0>
                  <#list user.roleList as role>
                    <label class="checkbox-inline">
                      ${role.name!}
                    </label>
                  </#list>
                <#else>
                  <label class="checkbox-inline">
                    暂无职位
                  </label>
                </#if>
              </div>
            </div>
            <div class="form-group">
              <label for="username" class="col-sm-2 control-label">员工编号</label>
              <div class="col-sm-10">
                <input type="text" disabled class="form-control" value="${user.serialNumber!}"/>
              </div>
            </div>
            <div class="form-group">
              <label class="col-sm-2 control-label">头像</label>
              <div class="col-sm-10">
                <img src="${user.icon!'/img/icon.png'}" width="100px" height="100px">
                <input type="file" name="file" accept="image/*">
              </div>
            </div>
            <div class="form-group">
              <label for="username" class="col-sm-2 control-label">用户名</label>
              <div class="col-sm-10">
                <input type="text" name="username" class="form-control" id="username" value="${user.username!}"/>
              </div>
            </div>
            <div class="form-group">
              <label for="username" class="col-sm-2 control-label">姓名</label>
              <div class="col-sm-10">
                <input type="text" name="name" class="form-control" value="${user.name!}"/>
              </div>
            </div>
            <div class="form-group">
              <label for="username" class="col-sm-2 control-label">电话</label>
              <div class="col-sm-10">
                <input type="text" name="phone" class="form-control" value="${user.phone!}"/>
              </div>
            </div>
            <div class="form-group">
              <label for="username" class="col-sm-2 control-label">邮箱</label>
              <div class="col-sm-10">
                <input type="email" name="email" class="form-control" value="${user.email!}"/>
              </div>
            </div>
            <div class="form-group">
              <div class="col-sm-offset-2 col-sm-10">
                <button type="submit" class="btn btn-default">修改</button>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>
<section class="content table-content">
  <table id="dataGrid"></table>
</section>
<#include "common/footer.html"/>
<#include "common/bootstrap-table.html"/>
<script type="text/javascript">
    /**
     * 表单初始化
     */
    $(function () {
        initDataGrid('/console/userSalary/list?userId=${user.id}', [
            {
                title: "序号", field: "id", formatter: function (value, row, index) {
                    //获取每页显示的数量
                    var pageSize = $table.bootstrapTable('getOptions').pageSize;
                    //获取当前是第几页
                    var pageNumber = $table.bootstrapTable('getOptions').pageNumber;
                    //返回序号，注意index是从0开始的，所以要加上1
                    return pageSize * (pageNumber - 1) + index + 1;
                }
            },
            {title: "发放日期", field: "sendTime"},
            {title: "基本薪资", field: "salary"},
            {title: "加班费", field: "overtimePay"},
            {title: "绩效", field: "performance"},
            {title: "全勤奖", field: "perfectAttendanceAward"},
            {title: "保险费", field: "insurance"},
            {title: "加班次数", field: "overtime"},
            {title: "状态", field: "createTime", formatter: getStatus},
            {title: "注册时间", field: "createTime"},
            {title: "更新时间", field: "updateTime"}
        ]);
    });

    function getStatus(value, row, index) {
        if (row.status === "WAIT") {
            return "待发放"
        } else {
            return "已发放";
        }
    }
</script>
</body>
</html>