<!DOCTYPE HTML>
<html lang="en">
<#include "../common/head.html"/>
<body>
<section class="content-header">
  <h1>审批管理</h1>
  <small>审批列表</small>
</section>
<section class="content table-content">


  <#if errorMessage??>
    <div class="alert alert-success alert-dismissible fade in" role="alert">
      <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span>
      </button>
      ${errorMessage!}
    </div>
  </#if>
  <table id="dataGrid"></table>
</section>
<div id="toolbar">
  <a href="/console/approval/detail/0" class="btn btn-primary">添加审批</a>
</div>
<#include "../common/footer.html"/>
<#include "../common/bootstrap-table.html"/>
</body>
<script type="text/javascript">
    /**
     * 表单初始化
     */
    $(function () {
        initDataGrid('/console/approval/list?userId=${sessionUser.id}', [
            {
                title: "序号", field: "id", formatter: function (value, row, index) {
                    //获取每页显示的数量
                    var pageSize = $table.bootstrapTable('getOptions').pageSize;
                    //获取当前是第几页
                    var pageNumber = $table.bootstrapTable('getOptions').pageNumber;
                    //返回序号，注意index是从0开始的，所以要加上1
                    return pageSize * (pageNumber - 1) + index + 1;
                }
            },
            {title: "申请类型", field: "type"},
            {title: "备注", field: "remark"},
            {title: "审批结果", field: "opinion"},
            {title: "状态", field: "status", formatter: getStatus},
            {title: "申请时间", field: "createTime"},
            {title: "更新时间", field: "updateTime"},
        ]);
    });

    function getStatus(value, row, index) {
        if (row.status === "WAIT") {
            return "待审核"
        } else if (row.status === "AGREE") {
            return "同意"
        } else {
            return "拒绝";
        }
    }
</script>
</html>